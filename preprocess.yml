import argparse
import pandas as pd
from sklearn.preprocessing import StandardScaler, LabelEncoder

parser = argparse.ArgumentParser()
parser.add_argument("--input_data", type=str)
parser.add_argument("--output_data", type=str)
args = parser.parse_args()

# Charger les données
df = pd.read_csv(args.input_data)

# Suppression des colonnes inutiles
df = df.drop(columns=["id", "timestamp"], errors="ignore")

# Encodage des labels (si applicable)
if "label" in df.columns:
    label_encoder = LabelEncoder()
    df["label"] = label_encoder.fit_transform(df["label"])

# Normalisation des données
scaler = StandardScaler()
df.iloc[:, :-1] = scaler.fit_transform(df.iloc[:, :-1])

# Sauvegarde des données prétraitées
df.to_csv(args.output_data, index=False)
print(f"✅ Données prétraitées sauvegardées dans {args.output_data}")